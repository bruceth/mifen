"use strict";(self.webpackChunkmi=self.webpackChunkmi||[]).push([[591],{1591:function(t,e,n){n.r(e),n.d(e,{CForget:function(){return V},CRegBase:function(){return j},CRegister:function(){return S}});var r=n(4165),a=n(5861),i=n(5671),u=n(3144),s=n(9340),c=n(4062),o=n(3284),l=n(9225),h=(n(2791),n(4346)),p=n(184),f=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){var t;(0,i.Z)(this,n);for(var u=arguments.length,s=new Array(u),c=0;c<u;c++)s[c]=arguments[c];return(t=e.call.apply(e,[this].concat(s))).schema=[{name:"user",type:"string",required:!0,maxLength:100},{name:"verify",type:"submit"}],t.uiSchema=void 0,t.onSubmit=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){var i,u,s,c,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.clearContextErrors(),i="user",u=a.getValue(i),void 0!==(s=(0,h.j)(u))){e.next=7;break}return a.setError(i,"\u5fc5\u987b\u662f\u624b\u673a\u53f7\u6216\u90ae\u7bb1"),e.abrupt("return");case 7:if("mobile"!==(c=s.type)){e.next=12;break}if(11===u.length&&"1"===u[0]){e.next=12;break}return a.setError(i,"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7"),e.abrupt("return");case 12:return t.controller.account=u,t.controller.type=c,e.next=16,t.controller.checkAccount();case 16:void 0!==(o=e.sent)&&a.setError(i,o);case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.onEnter=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("user"!==n){e.next=4;break}return e.next=3,t.onSubmit("verify",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t}return(0,u.Z)(n,[{key:"init",value:function(){this.uiSchema={items:{user:{widget:"text",label:this.accountLable,placeholder:"\u624b\u673a\u53f7\u6216\u90ae\u7bb1"},verify:{widget:"button",className:"btn btn-primary btn-block mt-3",label:"\u53d1\u9001\u9a8c\u8bc1\u7801"}}}}},{key:"header",value:function(){return this.pageCaption}},{key:"content",value:function(){return(0,p.jsxs)("div",{className:"w-max-20c my-5 py-5",style:{marginLeft:"auto",marginRight:"auto"},children:[(0,h.t)(),(0,p.jsx)("div",{className:"h-3c"}),(0,p.jsx)(l.l0,{schema:this.schema,uiSchema:this.uiSchema,onButtonClick:this.onSubmit,onEnter:this.onEnter,requiredFlag:!1}),(0,p.jsx)("div",{className:"text-center py-3",children:(0,p.jsx)(l.Ax,{href:"/login",className:"text-primary",children:"\u5df2\u6709\u8d26\u53f7\uff0c\u76f4\u63a5\u767b\u5f55"})}),l.$n.privacyEntry()]})}}]),n}(o.ps),m=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"accountLable",get:function(){return"\u8d26\u53f7"}},{key:"pageCaption",get:function(){return"\u6ce8\u518c\u8d26\u53f7"}}]),n}(f),y=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"footer",value:function(){return null}},{key:"accountLable",get:function(){return"\u8d26\u53f7"}},{key:"pageCaption",get:function(){return"\u5bc6\u7801\u627e\u56de"}}]),n}(f),d=n(1434),v=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){var t;(0,i.Z)(this,n);for(var u=arguments.length,s=new Array(u),c=0;c<u;c++)s[c]=arguments[c];return(t=e.call.apply(e,[this].concat(s))).schema=[{name:"verify",type:"number",required:!0,maxLength:6},{name:"submit",type:"submit"}],t.onVerifyChanged=function(t,e,n){t.setDisabled("submit",!e||6!==e.length)},t.uiSchema={items:{verify:{widget:"text",label:"\u9a8c\u8bc1\u7801",placeholder:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",onChanged:t.onVerifyChanged},submit:{widget:"button",className:"btn btn-primary btn-block mt-3",label:"\u4e0b\u4e00\u6b65 >",disabled:!0}}},t.onVerify=void 0,t.onSubmit=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){var i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.getValue("verify"),e.next=3,t.onVerify(i);case 3:if(0!==e.sent){e.next=7;break}return a.setError("verify","\u9a8c\u8bc1\u7801\u9519\u8bef"),e.abrupt("return");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.onEnter=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("verify"!==n){e.next=4;break}return e.next=3,t.onSubmit("submit",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t}return(0,u.Z)(n,[{key:"init",value:function(t){this.onVerify=t}},{key:"header",value:function(){return"\u9a8c\u8bc1\u7801"}},{key:"content",value:function(){var t,e;switch(this.controller.type){case"mobile":t="\u624b\u673a\u53f7";break;case"email":t="\u90ae\u7bb1",e=(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("span",{className:"text-danger",children:"\u6ce8\u610f"}),": \u6709\u53ef\u80fd\u8bef\u4e3a\u5783\u573e\u90ae\u4ef6\uff0c\u8bf7\u68c0\u67e5",(0,p.jsx)("br",{})]})}return(0,p.jsxs)("div",{className:"w-max-20c my-5 py-5",style:{marginLeft:"auto",marginRight:"auto"},children:["\u9a8c\u8bc1\u7801\u5df2\u7ecf\u53d1\u9001\u5230",t,(0,p.jsx)("br",{}),(0,p.jsx)("div",{className:"py-2 px-3 my-2 text-primary bg-light",children:(0,p.jsx)("b",{children:this.controller.account})}),e,(0,p.jsx)("div",{className:"h-1c"}),(0,p.jsx)(l.l0,{schema:this.schema,uiSchema:this.uiSchema,onButtonClick:this.onSubmit,onEnter:this.onEnter,requiredFlag:!1})]})}}]),n}(o.ps),b=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){var t;(0,i.Z)(this,n);for(var u=arguments.length,s=new Array(u),c=0;c<u;c++)s[c]=arguments[c];return(t=e.call.apply(e,[this].concat(s))).schema=[{name:"pwd",type:"string",required:!0,maxLength:100},{name:"rePwd",type:"string",required:!0,maxLength:100},{name:"submit",type:"submit"}],t.onButtonSubmit=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){var i,u,s,c;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.form.data,u=i.pwd,s=i.rePwd,u&&u===s){e.next=9;break}a.setValue("pwd",""),a.setValue("rePwd",""),c="\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165\u5bc6\u7801\uff01",a.setError("pwd",c),e.next=13;break;case 9:return e.next=11,t.controller.onPasswordSubmit(u);case 11:void 0!==(c=e.sent)&&l.$n.push((0,p.jsx)(l.T3,{header:"\u6ce8\u518c\u4e0d\u6210\u529f",children:(0,p.jsx)("div",{className:"p-5 text-danger",children:c})}));case 13:return e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.onEnter=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n,a){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("rePwd"!==n){e.next=4;break}return e.next=3,t.onButtonSubmit("submit",a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t}return(0,u.Z)(n,[{key:"account",get:function(){return this.controller.account}},{key:"header",value:function(){return this.pageCaption}},{key:"content",value:function(){var t={items:{pwd:{widget:"password",placeholder:"\u5bc6\u7801",label:"\u5bc6\u7801"},rePwd:{widget:"password",placeholder:"\u91cd\u590d\u5bc6\u7801",label:"\u91cd\u590d\u5bc6\u7801"},submit:{widget:"button",className:"btn btn-primary btn-block mt-3",label:this.submitCaption}}};return(0,p.jsxs)("div",{className:"w-max-20c my-5 py-5",style:{marginLeft:"auto",marginRight:"auto"},children:["\u6ce8\u518c\u8d26\u53f7",(0,p.jsx)("br",{}),(0,p.jsx)("div",{className:"py-2 px-3 my-2 text-primary bg-light",children:(0,p.jsx)("b",{children:this.account})}),(0,p.jsx)("div",{className:"h-1c"}),(0,p.jsx)(l.l0,{schema:this.schema,uiSchema:t,onButtonClick:this.onButtonSubmit,onEnter:this.onEnter,requiredFlag:!1})]})}}]),n}(o.ps),x=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"pageCaption",get:function(){return"\u6ce8\u518c\u8d26\u53f7"}},{key:"submitCaption",get:function(){return"\u6ce8\u518c\u65b0\u8d26\u53f7"}}]),n}(b),g=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"pageCaption",get:function(){return"\u8d26\u53f7\u5bc6\u7801"}},{key:"submitCaption",get:function(){return"\u6539\u5bc6\u7801"}}]),n}(b),k=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"header",value:function(){return!1}}]),n}(o.ps),Z=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"content",value:function(){var t=this.controller,e=t.account,n=t.login;return(0,p.jsx)("div",{className:"container w-max-30c",children:(0,p.jsxs)("div",{className:"my-5",children:[(0,p.jsxs)("div",{className:"py-5 text-center",children:["\u8d26\u53f7 ",(0,p.jsxs)("strong",{className:"text-primary",children:[e," "]})," \u6ce8\u518c\u6210\u529f\uff01"]}),(0,p.jsx)("button",{className:"btn btn-success btn-block",type:"button",onClick:function(){return n(void 0)},children:"\u76f4\u63a5\u767b\u5f55"})]})})}}]),n}(k),w=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"content",value:function(){var t=this.controller.login;return(0,p.jsx)("div",{className:"container w-max-30c",children:(0,p.jsxs)("div",{className:"my-5",children:[(0,p.jsx)("div",{className:"py-5 text-center text-success",children:"\u6210\u529f\u4fee\u6539\u5bc6\u7801"}),(0,p.jsx)("button",{className:"btn btn-primary btn-block",onClick:function(){return t()},children:"\u767b\u5f55\u8d26\u53f7"})]})})}}]),n}(k),j=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){var t;(0,i.Z)(this,n);for(var u=arguments.length,s=new Array(u),c=0;c<u;c++)s[c]=arguments[c];return(t=e.call.apply(e,[this].concat(s))).account=void 0,t.type=void 0,t.password=void 0,t.verify=void 0,t.login=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.BG.login({user:n||t.account,pwd:t.password,guest:l.$n.guest});case 2:if(void 0!==(a=e.sent)){e.next=6;break}return alert("something wrong!"),e.abrupt("return");case 6:return e.next=8,l.$n.userLogined(a);case 8:t.isWebNav&&l.$n.navigate("/");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t}return(0,u.Z)(n,[{key:"internalStart",value:function(){var t=(0,a.Z)((0,r.Z)().mark((function t(){return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.openVPage(this.VStart);case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"VVerify",get:function(){return v}},{key:"toVerify",value:function(){var t=this;this.openVPage(this.VVerify,function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.verify=n,e.next=3,d.BG.checkVerify(t.account,n);case 3:if(0!==(a=e.sent)){e.next=6;break}return e.abrupt("return",a);case 6:t.toPassword();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"toPassword",value:function(){this.openVPage(this.VPassword)}},{key:"toSuccess",value:function(){this.openVPage(this.VSuccess)}},{key:"checkAccount",value:function(){var t=(0,a.Z)((0,r.Z)().mark((function t(){var e,n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.BG.isExists(this.account);case 2:if(e=t.sent,void 0===(n=this.accountError(e))){t.next=6;break}return t.abrupt("return",n);case 6:return t.next=8,d.BG.sendVerify(this.account,this.type,l.$n.oem);case 8:return e=t.sent,this.toVerify(),t.abrupt("return");case 11:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),n}(o.Qr),S=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"VStart",get:function(){return m}},{key:"VPassword",get:function(){return x}},{key:"VSuccess",get:function(){return Z}},{key:"accountError",value:function(t){if(t>0)return"\u5df2\u7ecf\u88ab\u6ce8\u518c\u4f7f\u7528\u4e86"}},{key:"onPasswordSubmit",value:function(){var t=(0,a.Z)((0,r.Z)().mark((function t(e){var n,a,i;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.password=e,n={nick:void 0,user:this.account,pwd:e,country:void 0,mobile:void 0,mobileCountry:void 0,email:void 0,verify:this.verify},t.t0=this.type,t.next="mobile"===t.t0?5:"email"===t.t0?8:10;break;case 5:return n.mobile=Number(this.account),n.mobileCountry=86,t.abrupt("break",10);case 8:return n.email=this.account,t.abrupt("break",10);case 10:return t.next=12,d.BG.register(n);case 12:if(0!==(a=t.sent)){t.next=17;break}return l.$n.clear(),this.toSuccess(),t.abrupt("return");case 17:return i=this.regReturn(a),t.abrupt("return",i);case 19:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"regReturn",value:function(t){var e;switch(t){default:return"\u670d\u52a1\u5668\u53d1\u751f\u9519\u8bef";case 4:return"\u9a8c\u8bc1\u7801\u9519\u8bef";case 0:return;case 1:e="\u7528\u6237\u540d "+this.account;break;case 2:e="\u624b\u673a\u53f7 +"+this.account;break;case 3:e="\u90ae\u7bb1 "+this.account}return e+" \u5df2\u7ecf\u88ab\u6ce8\u518c\u8fc7\u4e86"}}]),n}(j),V=function(t){(0,s.Z)(n,t);var e=(0,c.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,u.Z)(n,[{key:"VStart",get:function(){return y}},{key:"VPassword",get:function(){return g}},{key:"VSuccess",get:function(){return w}},{key:"accountError",value:function(t){if(0===t)return"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8d26\u53f7"}},{key:"onPasswordSubmit",value:function(){var t=(0,a.Z)((0,r.Z)().mark((function t(e){var n;return(0,r.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.password=e,t.next=3,d.BG.resetPassword(this.account,this.password,this.verify,this.type);case 3:if(0!==t.sent.length){t.next=8;break}throw n="something wrong in reseting password",console.log(n),n;case 8:return l.$n.clear(),this.toSuccess(),t.abrupt("return");case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),n}(j)}}]);
//# sourceMappingURL=591.4652d579.chunk.js.map